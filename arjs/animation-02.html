<!DOCTYPE html>
<html>
  <head>
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
  </head>
  <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>

  <script>
    AFRAME.registerComponent("onclick", {
      init: function() {
        const animation = () => {
          console.log("clicked");
          this.el.removeAttribute("animation-mixer");
          this.el.setAttribute("animation-mixer", {
            clip: "action",
            loop: "once",
          });
        };
        this.el.addEventListener("click", animation);

        const afterAnmation = () => {
          this.el.removeEventListener("animation-finished", afterAnmation);
          this.el.setAttribute("animation-mixer", {
            clip: "idle",
            loop: "repeat"
          });
        };
        this.el.addEventListener("animation-finished", afterAnmation);
      }
    });
  </script>

  <body style="margin: 0px; overflow: hidden">
    <!-- we add detectionMode and matrixCodeType to tell AR.js to recognize barcode markers -->
    <a-scene
      vr-mode-ui="enabled: false"
      renderer="antialias: true; logarithmicDepthBuffer: true; colorManagement: true; sortObjects: true;"
      stats
    >
      <a-assets>
        <a-asset-item
          id="dance"
          src="../Assets/singham.glb"
        ></a-asset-item>
      </a-assets>

      <a-camera
        look-controls-enabled="true"
        wasd-controls-enabled="false"
        id="camera"
        position="0 8 8"
        raycaster="objects: .cantap"
        cursor="
          fuse: false;
          rayOrigin: mouse;"
      >
      </a-camera>
      <a-entity
        id="anim1"
        onclick
        class="cantap"
        gltf-model="#dance"
        animation-mixer="clip: idle; loop: repeat"
        position="0 -25 -80"
        scale="30 30 30"
      ></a-entity>
    </a-scene>
  </body>
</html>
